<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">transformer转换 | Usync</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://unicm.github.io/Usync/docs/使用文档/transformer/transformer转换"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="transformer转换 | Usync"><meta data-react-helmet="true" name="description" content="Transformer定义"><meta data-react-helmet="true" property="og:description" content="Transformer定义"><link data-react-helmet="true" rel="icon" href="/Usync/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://unicm.github.io/Usync/docs/使用文档/transformer/transformer转换"><link data-react-helmet="true" rel="alternate" href="https://unicm.github.io/Usync/docs/使用文档/transformer/transformer转换" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://unicm.github.io/Usync/docs/使用文档/transformer/transformer转换" hreflang="x-default"><link rel="stylesheet" href="/Usync/assets/css/styles.866f7346.css">
<link rel="preload" href="/Usync/assets/js/runtime~main.725f0c34.js" as="script">
<link rel="preload" href="/Usync/assets/js/main.eb8a7969.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Usync/"><div class="navbar__logo"><img src="/Usync/img/logo.svg" alt="Usync Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/Usync/img/logo.svg" alt="Usync Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Usync</b></a><a class="navbar__item navbar__link navbar__link--active" href="/Usync/docs/">文档中心</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/unicm/Usync" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Usync/docs/">Usync</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/Usync/docs/使用文档/">使用文档</a><button aria-label="Toggle the collapsible sidebar category &#x27;使用文档&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/Usync/docs/使用文档/reader/ftpReader">reader</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/Usync/docs/使用文档/writer/clickhouseWriter">writer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/Usync/docs/使用文档/transformer/transformer转换">transformer</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Usync/docs/使用文档/transformer/transformer转换">transformer转换</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/Usync/docs/使用文档/other/指标上报">other</a></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>transformer转换</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="transformer定义">Transformer定义<a class="hash-link" href="#transformer定义" title="Direct link to heading">​</a></h2><p>在数据同步、传输过程中，存在用户对于数据传输进行特殊定制化的需求场景，包括裁剪列、转换列等工作，可以借助ETL的T过程实现(Transformer)。Usync 包含了完整的E(Extract)、T(Transformer)、L(Load)支持。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="运行模型">运行模型<a class="hash-link" href="#运行模型" title="Direct link to heading">​</a></h2><img src="/Usync/assets/images/image-b619b910b6bfed65d35854cd3abd3468.png" alt="Example banner"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="udf手册">UDF手册<a class="hash-link" href="#udf手册" title="Direct link to heading">​</a></h2><ol><li>dx_substr</li></ol><ul><li>参数：3个<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：字段值的开始位置。</li><li>第三个参数：目标字段长度。</li></ul></li><li>返回： 从字符串的指定位置（包含）截取指定长度的字符串。如果开始位置非法抛出异常。如果字段为空值，直接返回（即不参与本transformer）</li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dx_substr(1,&quot;2&quot;,&quot;5&quot;)  column 1的value为“UsyncTest”=&gt;&quot;taxTe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dx_substr(1,&quot;5&quot;,&quot;10&quot;)  column 1的value为“UsyncTest”=&gt;&quot;Test&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>dx_pad</li></ol><ul><li>参数：4个<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：&quot;l&quot;,&quot;r&quot;, 指示是在头进行pad，还是尾进行pad。</li><li>第三个参数：目标字段长度。</li><li>第四个参数：需要pad的字符。</li></ul></li><li>返回： 如果源字符串长度小于目标字段长度，按照位置添加pad字符后返回。如果长于，直接截断（都截右边）。如果字段为空值，转换为空字符串进行pad，即最后的字符串全是需要pad的字符</li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">         dx_pad(1,&quot;l&quot;,&quot;4&quot;,&quot;A&quot;), 如果column 1 的值为 xyz=&gt; Axyz， 值为 xyzzzzz =&gt; xyzz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         dx_pad(1,&quot;r&quot;,&quot;4&quot;,&quot;A&quot;), 如果column 1 的值为 xyz=&gt; xyzA， 值为 xyzzzzz =&gt; xyzz</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>dx_replace</li></ol><ul><li>参数：4个<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：字段值的开始位置。</li><li>第三个参数：需要替换的字段长度。</li><li>第四个参数：需要替换的字符串。</li></ul></li><li>返回： 从字符串的指定位置（包含）替换指定长度的字符串。如果开始位置非法抛出异常。如果字段为空值，直接返回（即不参与本transformer）</li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dx_replace(1,&quot;2&quot;,&quot;4&quot;,&quot;****&quot;)  column 1的value为“UsyncTest”=&gt;&quot;Us****est&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dx_replace(1,&quot;5&quot;,&quot;10&quot;,&quot;****&quot;)  column 1的value为“UsyncTest”=&gt;&quot;Usyn****&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>dx_filter （关联filter暂不支持，即多个字段的联合判断，函参太过复杂，用户难以使用。）</li></ol><ul><li>参数：<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：运算符，支持一下运算符：like, not like, &gt;, =, &lt;, &gt;=, !=, &lt;=</li><li>第三个参数：正则表达式（java正则表达式）、值。 </li></ul></li><li>返回：<ul><li>如果匹配正则表达式，返回Null，表示过滤该行。不匹配表达式时，表示保留该行。（注意是该行）。对于&gt;=&lt;都是对字段直接compare的结果.</li><li>like ， not like是将字段转换成String，然后和目标正则表达式进行全匹配。</li><li><blockquote><p>, =, &lt;, &gt;=, !=, &lt;= 对于DoubleColumn比较double值，对于LongColumn和DateColumn比较long值，其他StringColumn，BooleanColumn以及ByteColumn均比较的是StringColumn值。</p></blockquote></li><li>如果目标colunn为空（null），对于 = null的过滤条件，将满足条件，被过滤。！=null的过滤条件，null不满足过滤条件，不被过滤。 like，字段为null不满足条件，不被过滤，和not like，字段为null满足条件，被过滤。</li></ul></li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dx_filter(1,&quot;like&quot;,&quot;dataTest&quot;)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dx_filter(1,&quot;&gt;=&quot;,&quot;10&quot;)  </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="5"><li>dx_groovy</li></ol><ul><li>参数。<ul><li>第一个参数： groovy code</li><li>第二个参数（列表或者为空）：extraPackage </li></ul></li><li>备注：<ul><li>dx_groovy只能调用一次。不能多次调用。</li><li>groovy code中支持java.lang, java.util的包，可直接引用的对象有record，以及element下的各种column（BoolColumn.class,BytesColumn.class,DateColumn.class,DoubleColumn.class,LongColumn.class,StringColumn.class）。不支持其他包，如果用户有需要用到其他包，可设置extraPackage，注意extraPackage不支持第三方jar包。</li><li>groovy code中，返回更新过的Record（比如record.setColumn(columnIndex, new StringColumn(newValue));），或者null。返回null表示过滤此行。</li><li>用户可以直接调用静态的Util方式（GroovyTransformerStaticUtil），目前GroovyTransformerStaticUtil的方法列表 (按需补充)：</li></ul></li><li>举例:</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">groovy 实现的subStr:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String code = &quot;Column column = record.getColumn(1);\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String oriValue = column.asString();\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String newValue = oriValue.substring(0, 3);\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; return record;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dx_groovy(record);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">groovy 实现的Replace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String code2 = &quot;Column column = record.getColumn(1);\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String oriValue = column.asString();\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String newValue = \&quot;****\&quot; + oriValue.substring(3, oriValue.length());\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; return record;&quot;;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">groovy 实现的Pad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String code3 = &quot;Column column = record.getColumn(1);\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String oriValue = column.asString();\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String padString = \&quot;12345\&quot;;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String finalPad = \&quot;\&quot;;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; int NeedLength = 8 - oriValue.length();\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;        while (NeedLength &gt; 0) {\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;            if (NeedLength &gt;= padString.length()) {\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;                finalPad += padString;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;                NeedLength -= padString.length();\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;            } else {\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;                finalPad += padString.substring(0, NeedLength);\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;                NeedLength = 0;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;            }\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;        }\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; String newValue= finalPad + oriValue;\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; record.setColumn(1, new StringColumn(newValue));\n&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot; return record;&quot;;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="6"><li>dx_encrypt</li></ol><ul><li>参数：<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：加密密钥，可选，缺省采用默认值：lt_usync_encryptAndDecrypt</li></ul></li><li>返回：<ul><li>对指定字段的内容进行加密操作。如果字段为空值，直接返回（即不参与本transformer）</li><li>参数不能为空，否则抛出异常，跳过这次算子的执行</li></ul></li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dx_encrypt(1,&quot;key_custom&quot;)  对column 1的value采用密钥key_custom进行加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dx_encrypt(1)  对column 1的value采用平台默认密钥进行加密</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="7"><li>dx_decrypt</li></ol><ul><li>参数：<ul><li>第一个参数：字段编号，对应record中第几个字段。</li><li>第二个参数：解密密钥，可选，缺省采用默认值：lt_usync_encryptAndDecrypt</li></ul></li><li>返回：对指定字段的内容进行解密操作。如果字段为空值，直接返回（即不参与本transformer）</li><li>举例：</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">dx_decrypt(1,&quot;key_custom&quot;) 对column 1的value采用密钥key_custom进行解密 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dx_encrypt(1)  对column 1的value采用平台默认密钥进行解密</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="job定义">Job定义<a class="hash-link" href="#job定义" title="Direct link to heading">​</a></h2><ul><li>本例中，配置3个UDF。</li></ul><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;job&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;setting&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;speed&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;channel&quot;: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;errorLimit&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;record&quot;: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;content&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;reader&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;name&quot;: &quot;streamreader&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;parameter&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;column&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;value&quot;: &quot;Usync&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;type&quot;: &quot;string&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;value&quot;: 19890604,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;type&quot;: &quot;long&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;value&quot;: &quot;1989-06-04 00:00:00&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;type&quot;: &quot;date&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;value&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;type&quot;: &quot;bool&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;value&quot;: &quot;test&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                &quot;type&quot;: &quot;bytes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;sliceRecordCount&quot;: 100000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;writer&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;name&quot;: &quot;streamwriter&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;parameter&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;print&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;encoding&quot;: &quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;transformer&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;name&quot;: &quot;dx_substr&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;parameter&quot;: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;columnIndex&quot;:5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;paras&quot;:[&quot;1&quot;,&quot;3&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;name&quot;: &quot;dx_replace&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;parameter&quot;: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;columnIndex&quot;:4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;paras&quot;:[&quot;3&quot;,&quot;4&quot;,&quot;****&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;name&quot;: &quot;dx_groovy&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          &quot;parameter&quot;: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               &quot;code&quot;: &quot;//groovy code//&quot;,  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               &quot;extraPackage&quot;:[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               &quot;import somePackage1;&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               &quot;import somePackage2;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               ]                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="计量和脏数据">计量和脏数据<a class="hash-link" href="#计量和脏数据" title="Direct link to heading">​</a></h2><p>Transform过程涉及到数据的转换，可能造成数据的增加或减少，因此更加需要精确度量，包括：</p><ul><li>Transform的入参Record条数、字节数。</li><li>Transform的出参Record条数、字节数。</li><li>Transform的脏数据Record条数、字节数。</li><li>如果是多个Transform，某一个发生脏数据，将不会再进行后面的transform，直接统计为脏数据。</li><li>目前只提供了所有Transform的计量（成功，失败，过滤的count，以及transform的消耗时间）。</li></ul><p>涉及到运行过程的计量数据展现定义如下：</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Total 1000000 records, 22000000 bytes | Transform 100000 records(in), 10000 records(out) | Speed 2.10MB/s, 100000 records/s | Error 0 records, 0 bytes | Percentage 100.00%</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>注意，这里主要记录转换的输入输出，需要检测数据输入输出的记录数量变化。</strong></p><p>涉及到最终作业的计量数据展现定义如下：</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">任务启动时刻                    : 2015-03-10 17:34:21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">任务结束时刻                    : 2015-03-10 17:34:31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">任务总计耗时                    :                 10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">任务平均流量                    :            2.10MB/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">记录写入速度                    :         100000rec/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">转换输入总数            :             1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">转换输出总数            :             1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">读出记录总数                    :             1000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">同步失败总数                    :                   0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>注意，这里主要记录转换的输入输出，需要检测数据输入输出的记录数量变化。</strong></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/unicm/Usync/docs/使用文档\transformer\transformer转换.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Usync/docs/使用文档/writer/txtFileWriter"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TxtFileWriter 插件文档</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Usync/docs/使用文档/other/指标上报"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">监控数据上报中台</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#transformer定义" class="table-of-contents__link toc-highlight">Transformer定义</a></li><li><a href="#运行模型" class="table-of-contents__link toc-highlight">运行模型</a></li><li><a href="#udf手册" class="table-of-contents__link toc-highlight">UDF手册</a></li><li><a href="#job定义" class="table-of-contents__link toc-highlight">Job定义</a></li><li><a href="#计量和脏数据" class="table-of-contents__link toc-highlight">计量和脏数据</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/Usync/docs">文档中心</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/unicm/Usync" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>建议<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/unicm/Usync" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Usync. unicm团队. 所有.</div></div></div></footer></div>
<script src="/Usync/assets/js/runtime~main.725f0c34.js"></script>
<script src="/Usync/assets/js/main.eb8a7969.js"></script>
</body>
</html>